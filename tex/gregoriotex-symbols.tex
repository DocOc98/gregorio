%GregorioTeX file.
%
% Copyright (C) 2007-2015 The Gregorio Project (see CONTRIBUTORS.md)
%
% This file is part of Gregorio.
%
% Gregorio is free software: you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or
% (at your option) any later version.
%
% Gregorio is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with Gregorio.  If not, see <http://www.gnu.org/licenses/>.

% this file contains definitions of the symbols

\ifcsname gregoriotex@symbols@loaded\endcsname\endinput\fi%
\def\gregoriotex@symbols@loaded{}%

\gre@declarefileversion{gregoriotex-symbols.tex}{3.0.0-rc2}% GREGORIO_VERSION

\RequireLuaModule{gregoriotex}%

\def\gresymbolfontsize{\f@size}%

% Defines a symbol which automatically scales with \f@size
% #1 = control sequence name
% #2 = font name
% #3 = glyph name or code point
\def\gredefsymbol#1#2#3{%
  \directlua{gregoriotex.init_variant_font([[#2]],false)}%
  \directlua{gregoriotex.def_symbol([[#1]],[[#2]],[[#3]],false)}
}%

% Defines a symbol which takes a point size as argument
% #1 = control sequence name
% #2 = font name
% #3 = glyph name or code point
\def\gredefsizedsymbol#1#2#3{%
  \directlua{gregoriotex.init_variant_font([[#2]],false)}%
  \directlua{gregoriotex.def_symbol([[#1]],[[#2]],[[#3]],true)}
}%

%%%%%%%%%%%%%
%% symbols %%
%%%%%%%%%%%%%

\gredefsizedsymbol{greABar}{greextra}{ABar}
\gredefsizedsymbol{greRBar}{greextra}{RBar}
\gredefsizedsymbol{greVBar}{greextra}{VBar}
\gredefsizedsymbol{greABarSC}{greextra}{ABarSC}
\gredefsizedsymbol{greRBarSC}{greextra}{RBarSC}
\gredefsizedsymbol{greVBarSC}{greextra}{VBarSC}
\gredefsizedsymbol{greABarSmall}{greextra}{ABarSmall}
\gredefsizedsymbol{greRBarSmall}{greextra}{RBarSmall}
\gredefsizedsymbol{greVBarSmall}{greextra}{VBarSmall}
\gredefsizedsymbol{greABarSmallSC}{greextra}{ABarSmallSC}
\gredefsizedsymbol{greRBarSmallSC}{greextra}{RBarSmallSC}
\gredefsizedsymbol{greVBarSmallSC}{greextra}{VBarSmallSC}
\gredefsizedsymbol{greABarCaption}{greextra}{ABarCaption}
\gredefsizedsymbol{greRBarCaption}{greextra}{RBarCaption}
\gredefsizedsymbol{greVBarCaption}{greextra}{VBarCaption}
\gredefsizedsymbol{greABarCaptionSC}{greextra}{ABarCaptionSC}
\gredefsizedsymbol{greRBarCaptionSC}{greextra}{RBarCaptionSC}
\gredefsizedsymbol{greVBarCaptionSC}{greextra}{VBarCaptionSC}
\gredefsizedsymbol{greABarAlt}{greextra}{RBar.alt}
\gredefsizedsymbol{greRBarAlt}{greextra}{RBar.alt}
\gredefsizedsymbol{greVBarAlt}{greextra}{VBar.alt}

\def\greExplDefBarGlyph#1#2#3#4#5#6#7#8{%
  \expandafter\gdef\csname #1\endcsname {%
    #3\kern #6\lower#7\hbox{\csname #4\endcsname{#5}}\kern -#6%
    \kern #8%
  }%
}

\def\greDefBarGlyph#1#2#3#4{%
  \greExplDefBarGlyph{#1}{#2}{#2}{#3}{\f@size}{#4}{0pt}{0pt}%
}

% the gothic R and V
\gredefsymbol{gothRBar}{greextra}{RWithBarGoth}%
\gredefsymbol{gothVBar}{greextra}{VWithBarGoth}%

% the macro to typeset a dagger
\gredefsymbol{gredagger}{greextra}{Dagger}%

% macro to typeset a (malt) cross
\gredefsymbol{grecross}{greextra}{Cross}%
\gredefsymbol{grealtcross}{greextra}{Cross.alt}%

%stars
\gredefsymbol{greheightstar}{greextra}{StarHeight}%
\gredefsymbol{gresixstar}{greextra}{StarSix}%
\let\grestar\gresixstar%

%%%%%%%%%%%%
%%  Lines %%
%%%%%%%%%%%%
%Unlike the character symbols above, we require that the font size be specified when using the lines.

\gredefsizedsymbol{greLineOne}{greextra}{Line1}%
\gredefsizedsymbol{greLineTwo}{greextra}{Line2}%
\gredefsizedsymbol{greLineThree}{greextra}{Line3}%
\gredefsizedsymbol{greLineFour}{greextra}{Line4}%
\gredefsizedsymbol{greLineFive}{greextra}{Line5}%

%lines
%#1 is the type of line (1-5)
%#2 is the number of pt of the font it will use
\def\gresep#1#2{%
  \ifcase#1\relax %
  \or\greLineOne{#2}%
  \or\greLineTwo{#2}%
  \or\greLineThree{#2}%
  \or\greLineFour{#2}%
  \or\greLineFive{#2}%
  \fi%
}%
