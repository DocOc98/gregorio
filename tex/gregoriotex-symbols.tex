%GregorioTeX file.
%
% Copyright (C) 2007-2015 The Gregorio Project (see CONTRIBUTORS.md)
%
% This file is part of Gregorio.
%
% Gregorio is free software: you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or
% (at your option) any later version.
%
% Gregorio is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with Gregorio.  If not, see <http://www.gnu.org/licenses/>.

% this file contains definitions of the symbols

\ifcsname gregoriotex@symbols@loaded\endcsname\endinput\fi%
\def\gregoriotex@symbols@loaded{}%

\gre@declarefileversion{gregoriotex-symbols.tex}{3.0.0-rc2}% GREGORIO_VERSION

\RequireLuaModule{gregoriotex}%

\def\gresymbolfontsize{\f@size}%

% Defines a symbol which automatically scales with \f@size
% #1 = control sequence name
% #2 = font name
% #3 = glyph name or code point
\def\gredefsymbol#1#2#3{%
  \directlua{gregoriotex.init_variant_font([[#2]],false)}%
  \directlua{gregoriotex.def_symbol([[#1]],[[#2]],[[#3]],false)}
}%

% Defines a symbol which takes a point size as argument
% #1 = control sequence name
% #2 = font name
% #3 = glyph name or code point
\def\gredefsizedsymbol#1#2#3{%
  \directlua{gregoriotex.init_variant_font([[#2]],false)}%
  \directlua{gregoriotex.def_symbol([[#1]],[[#2]],[[#3]],true)}
}%

%%%%%%%%%%
%% symbols        %
%%%%%%%%%%

% the macros to typeset the A, R and V with bar
\gredefsymbol{greAbar}{greextra}{ABar}%
\def\Abar{%
  % TODO kern and compose with A
  \greAbar%
}%

\gredefsymbol{greRbar}{greextra}{RBar}%
\def\Rbar{%
  % TODO kern and compose with R
  \greRbar%
}%

\gredefsymbol{greVbar}{greextra}{VBar}%
\def\Vbar{%
  % TODO kern and compose with V
  \greVbar%
}%

% a V with bar more adapted to small text
\gredefsymbol{greVbarsmall}{greextra}{VBarSmall}%
\def\Vbarsmall{%
  % TODO kern and compose with V
  \greVbarsmall%
}%

% bars for the letters

%\def\greletterbar{%
%  \gre@reloadgresym%
%  {\gregoriosymbolfont \char 73}%
%  \relax%
%}%

%\def\greletteraltbar{%
%  \gre@reloadgresym%
%  {\gregoriosymbolfont \char 74}%
%  \relax%
%}%

% the gothic R and V
\gredefsymbol{gothRbar}{greextra}{RWithBarGoth}%
\gredefsymbol{gothVbar}{greextra}{VWithBarGoth}%

% the macro to typeset a dagger
\gredefsymbol{gredagger}{greextra}{Dagger}%

% macro to typeset a (malt) cross
\gredefsymbol{grecross}{greextra}{Cross}%
\gredefsymbol{grealtcross}{greextra}{Cross.alt}%

%stars
\gredefsymbol{greheightstar}{greextra}{StarHeight}%
\gredefsymbol{gresixstar}{greextra}{StarSix}%
\let\grestar\gresixstar%

%%%%%%%%%
%  Lines        %%
%%%%%%%%%
%Unlike the character symbols above, we require that the font size be specified when using the lines.

\gredefsizedsymbol{greLineOne}{greextra}{Line1}%
\gredefsizedsymbol{greLineTwo}{greextra}{Line2}%
\gredefsizedsymbol{greLineThree}{greextra}{Line3}%
\gredefsizedsymbol{greLineFour}{greextra}{Line4}%
\gredefsizedsymbol{greLineFive}{greextra}{Line5}%

%lines
%#1 is the type of line (1-5)
%#2 is the number of pt of the font it will use
\def\gresep#1#2{%
  \ifcase#1\relax %
  \or\greLineOne{#2}%
  \or\greLineTwo{#2}%
  \or\greLineThree{#2}%
  \or\greLineFour{#2}%
  \or\greLineFive{#2}%
  \fi%
}%
